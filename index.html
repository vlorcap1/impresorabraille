<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texto a Braille - Generador G-code</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            min-height: 120px;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .setting-item {
            display: flex;
            flex-direction: column;
        }
        
        .setting-item label {
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .setting-item input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .setting-item input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .braille-preview {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 24px;
            line-height: 1.8;
            min-height: 100px;
            border: 2px solid #e0e0e0;
            overflow-x: auto;
        }
        
        .gcode-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.5;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e0e0e0;
        }
        
        .btn-secondary:hover {
            background: #e9ecef;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .info-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }
        
        .info-box p {
            color: #555;
            line-height: 1.6;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }

        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-card .label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚†É Generador Braille a G-code</h1>
            <p>Convierte texto a Braille y genera G-code para tu impresora 3D</p>
        </div>
        
        <div class="content">
            <!-- Secci√≥n 1: Entrada de texto -->
            <div class="section">
                <h2>1Ô∏è‚É£ Ingresa tu texto</h2>
                <textarea id="inputText" placeholder="Escribe aqu√≠ el texto que quieres convertir a Braille...">Hola mundo</textarea>
            </div>
            
            <!-- Secci√≥n 2: Configuraci√≥n -->
            <div class="section">
                <h2>2Ô∏è‚É£ Configuraci√≥n de la impresora</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>Espaciado entre puntos (mm)</label>
                        <input type="number" id="dotSpacing" value="2.5" step="0.1" min="1">
                    </div>
                    <div class="setting-item">
                        <label>Espaciado entre caracteres (mm)</label>
                        <input type="number" id="charSpacing" value="6" step="0.1" min="3">
                    </div>
                    <div class="setting-item">
                        <label>Espaciado entre palabras (mm)</label>
                        <input type="number" id="wordSpacing" value="12" step="0.1" min="6">
                    </div>
                    <div class="setting-item">
                        <label>Altura de l√≠nea (mm)</label>
                        <input type="number" id="lineSpacing" value="10" step="0.1" min="5">
                    </div>
                    <div class="setting-item">
                        <label>Velocidad de movimiento (mm/min)</label>
                        <input type="number" id="feedRate" value="3000" step="100" min="500">
                    </div>
                    <div class="setting-item">
                        <label>Altura Z para punzar (mm)</label>
                        <input type="number" id="punchDepth" value="0.5" step="0.1" min="0.1">
                    </div>
                    <div class="setting-item">
                        <label>Altura Z en reposo (mm)</label>
                        <input type="number" id="restHeight" value="2" step="0.1" min="0.5">
                    </div>
                    <div class="setting-item">
                        <label>Tiempo de punzado (ms)</label>
                        <input type="number" id="punchDuration" value="100" step="10" min="50">
                    </div>
                    <div class="setting-item">
                        <label>Offset inicial X (mm)</label>
                        <input type="number" id="offsetX" value="20" step="1" min="10" max="50">
                    </div>
                    <div class="setting-item">
                        <label>Offset inicial Y (mm)</label>
                        <input type="number" id="offsetY" value="20" step="1" min="10" max="50">
                    </div>
                    <div class="setting-item">
                        <label>Potencia solenoide (0-255)</label>
                        <input type="number" id="solenoidPower" value="255" step="5" min="0" max="255">
                    </div>
                </div>
            </div>
            
            <!-- Secci√≥n 3: Vista previa Braille -->
            <div class="section">
                <h2>3Ô∏è‚É£ Vista previa Braille</h2>
                <div class="braille-preview" id="braillePreview"></div>
                <div class="stats">
                    <div class="stat-card">
                        <div class="number" id="charCount">0</div>
                        <div class="label">Caracteres</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="dotCount">0</div>
                        <div class="label">Puntos</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="lineCount">0</div>
                        <div class="label">L√≠neas</div>
                    </div>
                    <div class="stat-card">
                        <div class="number" id="estimatedTime">0</div>
                        <div class="label">Tiempo estimado (seg)</div>
                    </div>
                </div>
            </div>
            
            <!-- Secci√≥n 4: G-code -->
            <div class="section">
                <h2>4Ô∏è‚É£ G-code generado</h2>
                <div class="gcode-output" id="gcodeOutput">; El G-code aparecer√° aqu√≠...</div>
                <div class="button-group">
                    <button class="btn-primary" onclick="generateGcode()">
                        ‚öôÔ∏è Generar G-code
                    </button>
                    <button class="btn-secondary" onclick="downloadGcode()">
                        üíæ Descargar G-code
                    </button>
                    <button class="btn-secondary" onclick="copyGcode()">
                        üìã Copiar al portapapeles
                    </button>
                </div>
            </div>
            
            <!-- Informaci√≥n adicional -->
            <div class="info-box">
                <h3>üîß FlashForge Finder (Roja) - Configuraci√≥n</h3>
                <p><strong>üìê Especificaciones:</strong> Cama 140x140x140mm | √Årea √∫til: ~100x100mm</p>
                <p><strong>‚ö†Ô∏è IMPORTANTE - Conexi√≥n del solenoide:</strong></p>
                <p>‚Ä¢ <strong>Opci√≥n 1 (Recomendada):</strong> Con√©ctalo al puerto del <strong>ventilador de capa</strong> en la placa controladora (generalmente etiquetado como "FAN" o "COOLING FAN").</p>
                <p>‚Ä¢ <strong>Opci√≥n 2:</strong> Si tienes acceso, usa el puerto del <strong>calefactor del extrusor</strong> (modifica M106/M107 por M104/M109 en el c√≥digo).</p>
                <p><strong>Cableado:</strong> Abre la Finder por atr√°s, localiza la placa. Conecta: Solenoide + ‚Üí FAN +12V, Solenoide - ‚Üí GND</p>
                <p><strong>‚öôÔ∏è Calibraci√≥n:</strong></p>
                <p>1. Coloca cartulina 200g sobre la cama (NO uses vidrio, usa la superficie directa)</p>
                <p>2. Escribe solo "a" para prueba inicial</p>
                <p>3. Ajusta "Altura Z punzar" desde 0.5mm hasta que la aguja marque sin perforar</p>
                <p>4. M√°rgenes configurados en 20mm (√°rea segura de ~100x100mm)</p>
                <p><strong>üìÑ Cargar G-code:</strong> Guarda en USB (.gcode), ins√©rtalo en la Finder y selecciona desde pantalla t√°ctil.</p>
            </div>

            <div class="info-box" style="background: #e8f5e9; border-left-color: #4caf50; margin-top: 15px;">
                <h3>üîÑ Inversi√≥n autom√°tica para lectura correcta</h3>
                <p><strong>¬°IMPORTANTE!</strong> Este generador invierte autom√°ticamente el texto y los caracteres Braille en espejo.</p>
                <p><strong>¬øPor qu√©?</strong> Porque presionas desde arriba, los puntos quedan en relieve en la parte de ABAJO del papel.</p>
                <p><strong>C√≥mo leer:</strong> Despu√©s de imprimir, DA VUELTA el papel y l√©elo por el lado opuesto donde presionaste.</p>
                <p><strong>Ejemplo:</strong> Si escribes "HOLA", la impresora marca "ALOH" invertido. Al dar vuelta el papel, se lee correctamente "HOLA" en Braille.</p>
            </div>

            <div class="info-box" style="background: #fff3cd; border-left-color: #ffc107; margin-top: 15px;">
                <h3>üí° Tips espec√≠ficos para Finder</h3>
                <p><strong>√Årea de trabajo:</strong> M√°ximo ~100x100mm √∫til (m√°rgenes de 20mm configurados)</p>
                <p><strong>Velocidades recomendadas:</strong> 2000-3000 mm/min para movimientos XY | 600 mm/min para Z</p>
                <p><strong>Solenoide ideal:</strong> Push-pull 12V, 5-10mm de recorrido, fuerza 2-5N</p>
                <p><strong>Aguja:</strong> Di√°metro 1.5-2mm, punta roma (no afilada) | Longitud ~30-40mm</p>
                <p><strong>Soporte de montaje:</strong> Dise√±a un adaptador que se monte donde va el extrusor</p>
                <p><strong>Papel:</strong> Cartulina 180-220g da mejores resultados. F√≠jala con cinta en los bordes.</p>
            </div>
        </div>
    </div>

    <script>
        // Mapeo de caracteres a Braille (Grade 1 - espa√±ol)
        const brailleMap = {
            'a': '‚†Å', 'b': '‚†É', 'c': '‚†â', 'd': '‚†ô', 'e': '‚†ë',
            'f': '‚†ã', 'g': '‚†õ', 'h': '‚†ì', 'i': '‚†ä', 'j': '‚†ö',
            'k': '‚†Ö', 'l': '‚†á', 'm': '‚†ç', 'n': '‚†ù', 'o': '‚†ï',
            'p': '‚†è', 'q': '‚†ü', 'r': '‚†ó', 's': '‚†é', 't': '‚†û',
            'u': '‚†•', 'v': '‚†ß', 'w': '‚†∫', 'x': '‚†≠', 'y': '‚†Ω',
            'z': '‚†µ', '√°': '‚†∑', '√©': '‚†Æ', '√≠': '‚†å', '√≥': '‚†¨',
            '√∫': '‚†æ', '√º': '‚†≥', '√±': '‚†ª',
            '1': '‚†Å', '2': '‚†É', '3': '‚†â', '4': '‚†ô', '5': '‚†ë',
            '6': '‚†ã', '7': '‚†õ', '8': '‚†ì', '9': '‚†ä', '0': '‚†ö',
            '.': '‚†≤', ',': '‚†Ç', ';': '‚†Ü', ':': '‚†í', '?': '‚†¶',
            '!': '‚†ñ', '-': '‚†§', ' ': ' '
        };

        // Mapeo de Braille a puntos (matriz 2x3)
        const brailleDots = {
            '‚†Å': [1,0,0,0,0,0], '‚†É': [1,1,0,0,0,0], '‚†â': [1,0,0,1,0,0],
            '‚†ô': [1,0,0,1,1,0], '‚†ë': [1,0,0,0,1,0], '‚†ã': [1,1,0,1,0,0],
            '‚†õ': [1,1,0,1,1,0], '‚†ì': [1,1,0,0,1,0], '‚†ä': [0,1,0,1,0,0],
            '‚†ö': [0,1,0,1,1,0], '‚†Ö': [1,0,1,0,0,0], '‚†á': [1,1,1,0,0,0],
            '‚†ç': [1,0,1,1,0,0], '‚†ù': [1,0,1,1,1,0], '‚†ï': [1,0,1,0,1,0],
            '‚†è': [1,1,1,1,0,0], '‚†ü': [1,1,1,1,1,0], '‚†ó': [1,1,1,0,1,0],
            '‚†é': [0,1,1,1,0,0], '‚†û': [0,1,1,1,1,0], '‚†•': [1,0,1,0,0,1],
            '‚†ß': [1,1,1,0,0,1], '‚†∫': [0,1,0,1,1,1], '‚†≠': [1,0,1,1,0,1],
            '‚†Ω': [1,0,1,1,1,1], '‚†µ': [1,0,1,0,1,1], '‚†∑': [1,0,0,0,0,1],
            '‚†Æ': [0,1,1,1,0,1], '‚†å': [0,0,1,1,0,0], '‚†¨': [1,1,0,1,0,1],
            '‚†æ': [1,1,1,0,0,1], '‚†≥': [1,0,0,1,1,1], '‚†ª': [1,0,1,1,0,1],
            '‚†≤': [0,1,0,0,1,1], '‚†Ç': [0,1,0,0,0,0], '‚†Ü': [0,1,1,0,0,0],
            '‚†í': [0,1,0,0,1,0], '‚†¶': [0,1,1,0,0,1], '‚†ñ': [0,1,1,0,1,0],
            '‚†§': [0,0,1,0,0,1], ' ': [0,0,0,0,0,0]
        };

        let currentGcode = '';

        // Actualizar vista previa en tiempo real
        document.getElementById('inputText').addEventListener('input', updatePreview);

        function updatePreview() {
            const text = document.getElementById('inputText').value.toLowerCase();
            let brailleText = '';
            let charCount = 0;
            let dotCount = 0;
            
            for (let char of text) {
                if (char === '\n') {
                    brailleText += '\n';
                } else if (brailleMap[char]) {
                    brailleText += brailleMap[char];
                    charCount++;
                    const dots = brailleDots[brailleMap[char]];
                    if (dots) {
                        dotCount += dots.filter(d => d === 1).length;
                    }
                } else if (char === ' ') {
                    brailleText += ' ';
                }
            }
            
            document.getElementById('braillePreview').textContent = brailleText || 'La vista previa aparecer√° aqu√≠...';
            document.getElementById('charCount').textContent = charCount;
            document.getElementById('dotCount').textContent = dotCount;
            
            const lineCount = brailleText.split('\n').length;
            document.getElementById('lineCount').textContent = lineCount;
            
            // Estimar tiempo (puntos * duraci√≥n + movimientos)
            const punchDuration = parseInt(document.getElementById('punchDuration').value) || 100;
            const estimatedTime = ((dotCount * punchDuration) / 1000 + dotCount * 0.2).toFixed(1);
            document.getElementById('estimatedTime').textContent = estimatedTime;
        }

        // Funci√≥n para invertir horizontalmente los puntos Braille (espejo)
        function mirrorBrailleDots(dots) {
            // Braille original:  Espejo horizontal:
            // 1 4    =>    4 1
            // 2 5    =>    5 2  
            // 3 6    =>    6 3
            return [
                dots[3], // punto 4 va a posici√≥n 1
                dots[4], // punto 5 va a posici√≥n 2
                dots[5], // punto 6 va a posici√≥n 3
                dots[0], // punto 1 va a posici√≥n 4
                dots[1], // punto 2 va a posici√≥n 5
                dots[2]  // punto 3 va a posici√≥n 6
            ];
        }

        function generateGcode() {
            const text = document.getElementById('inputText').value.toLowerCase();
            const dotSpacing = parseFloat(document.getElementById('dotSpacing').value) || 2.5;
            const charSpacing = parseFloat(document.getElementById('charSpacing').value) || 6;
            const wordSpacing = parseFloat(document.getElementById('wordSpacing').value) || 12;
            const lineSpacing = parseFloat(document.getElementById('lineSpacing').value) || 10;
            const feedRate = parseInt(document.getElementById('feedRate').value) || 3000;
            const punchDepth = parseFloat(document.getElementById('punchDepth').value) || 0.5;
            const restHeight = parseFloat(document.getElementById('restHeight').value) || 2;
            const punchDuration = parseInt(document.getElementById('punchDuration').value) || 100;
            const offsetX = parseFloat(document.getElementById('offsetX').value) || 20;
            const offsetY = parseFloat(document.getElementById('offsetY').value) || 20;
            const solenoidPower = parseInt(document.getElementById('solenoidPower').value) || 255;

            let gcode = '; ========================================\n';
            gcode += '; BRAILLE G-CODE - FlashForge\n';
            gcode += '; ========================================\n';
            gcode += '; Generado: ' + new Date().toLocaleString() + '\n';
            gcode += `; Texto: ${text}\n`;
            gcode += '; Modelo: FlashForge (Adventurer/Finder)\n';
            gcode += '; ========================================\n\n';
            
            gcode += '; === INICIALIZACI√ìN FlashForge ===\n';
            gcode += 'M118 X16.00 Y16.00 Z18.00 T0 ; Tama√±o cama FlashForge\n';
            gcode += 'G21 ; Unidades en mil√≠metros\n';
            gcode += 'G90 ; Posicionamiento absoluto\n';
            gcode += 'M82 ; Extrusor en modo absoluto\n';
            gcode += 'M107 ; Apagar ventilador (solenoide OFF)\n';
            gcode += 'M104 S0 T0 ; Apagar extrusor\n';
            gcode += 'M140 S0 ; Apagar cama\n\n';
            
            gcode += '; === HOMING ===\n';
            gcode += 'G28 ; Home todos los ejes\n';
            gcode += 'G1 Z10 F600 ; Subir Z 10mm\n';
            gcode += 'G92 E0 ; Reset extrusor\n\n';
            
            gcode += '; === POSICI√ìN INICIAL ===\n';
            gcode += `G1 X${offsetX} Y${offsetY} F2000 ; Ir a inicio\n`;
            gcode += `G1 Z${restHeight} F600 ; Z a altura de reposo\n`;
            gcode += 'G4 P500 ; Pausa estabilizaci√≥n\n\n';
            gcode += '; === INICIO BRAILLE ===\n\n';

            let x = offsetX;
            let y = offsetY;
            let lineNum = 0;

            const lines = text.split('\n');
            
            for (let line of lines) {
                gcode += `; L√≠nea ${lineNum + 1}\n`;
                
                // INVERTIR la l√≠nea para lectura correcta del Braille
                const reversedLine = line.split('').reverse().join('');
                
                x = offsetX; // Reiniciar X al margen inicial de cada l√≠nea
                
                for (let i = 0; i < reversedLine.length; i++) {
                    const char = reversedLine[i];
                    
                    if (char === ' ') {
                        x += wordSpacing;
                        continue;
                    }
                    
                    const brailleChar = brailleMap[char];
                    if (!brailleChar) continue;
                    
                    const dots = brailleDots[brailleChar];
                    if (!dots) continue;
                    
                    // INVERTIR los puntos horizontalmente para lectura correcta
                    const mirroredDots = mirrorBrailleDots(dots);
                    
                    gcode += `; Car√°cter: '${char}' (${brailleChar}) [ESPEJO]\n`;
                    
                    // Matriz de puntos Braille (2 columnas x 3 filas)
                    // Punto 1,4 (columna 0)  Punto 2,5 (columna 1)  Punto 3,6 (columna 2)
                    const dotPositions = [
                        [0, 0],           // Punto 1
                        [0, dotSpacing],  // Punto 2
                        [0, dotSpacing*2],// Punto 3
                        [dotSpacing, 0],           // Punto 4
                        [dotSpacing, dotSpacing],  // Punto 5
                        [dotSpacing, dotSpacing*2] // Punto 6
                    ];
                    
                    // Punzar cada punto activo
                    // Secuencia correcta: 1) Subir Z  2) Mover XY  3) Bajar Z  4) Activar solenoide
                    for (let j = 0; j < 6; j++) {
                        if (mirroredDots[j] === 1) {
                            const px = x + dotPositions[j][0];
                            const py = y + dotPositions[j][1];
                            
                            gcode += `G1 Z${restHeight} F600 ; 1. Subir Z (seguro para trasladar)\n`;
                            gcode += `G1 X${px.toFixed(2)} Y${py.toFixed(2)} F${feedRate} ; 2. Mover XY a punto ${j+1}\n`;
                            gcode += `G1 Z${punchDepth} F600 ; 3. Bajar Z (punzar)\n`;
                            gcode += `M106 S${solenoidPower} ; 4. PRESIONAR solenoide\n`;
                            gcode += `G4 P${punchDuration} ; Mantener ${punchDuration}ms\n`;
                            gcode += `M107 ; Soltar solenoide\n`;
                        }
                    }
                    
                    // Subir Z despu√©s de terminar el car√°cter
                    gcode += `G1 Z${restHeight} F600 ; Subir Z fin de car√°cter\n`;
                    
                    x += charSpacing;
                }
                
                y += lineSpacing;
                lineNum++;
                gcode += '\n';
            }

            gcode += '\n; === FINALIZACI√ìN FlashForge ===\n';
            gcode += 'M107 ; Apagar solenoide\n';
            gcode += `G1 Z${restHeight + 10} F600 ; Subir Z seguro\n`;
            gcode += 'G1 X5 Y5 F2000 ; Posici√≥n segura\n';
            gcode += 'M104 S0 T0 ; Apagar extrusor\n';
            gcode += 'M140 S0 ; Apagar cama\n';
            gcode += 'M84 ; Desactivar motores\n';
            gcode += 'M300 S440 P200 ; Beep finalizaci√≥n\n';
            gcode += 'G4 P100\n';
            gcode += 'M300 S880 P200 ; Beep confirmaci√≥n\n';
            gcode += '; ========================================\n';
            gcode += '; FIN - Braille completado\n';
            gcode += '; ========================================\n';

            currentGcode = gcode;
            document.getElementById('gcodeOutput').textContent = gcode;
        }

        function downloadGcode() {
            if (!currentGcode) {
                alert('Primero genera el G-code');
                return;
            }
            
            const blob = new Blob([currentGcode], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'braille_output.gcode';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function copyGcode() {
            if (!currentGcode) {
                alert('Primero genera el G-code');
                return;
            }
            
            navigator.clipboard.writeText(currentGcode).then(() => {
                alert('G-code copiado al portapapeles');
            });
        }

        // Inicializar vista previa
        updatePreview();
    </script>
</body>
</html>
</body>
</html>
